{"iastd":{"target":"c++","imports":[],"type_definitions":{"schemas":[],"native_types":{"window1*":{"type_symbol":"window1*","destructor":"~window()"},"std::map<int,std::vector<int>>":{"type_symbol":"map","destructor":"~map()"},"model*":{"type_symbol":"model.h","destructor":"~model()"},"double":{"type_symbol":"double","destructor":"delete"},"std::vector<std::string>":{"type_symbol":"vector","destructor":"~vector()"},"std::map<string,model*>":{"type_symbol":"map","destructor":"~map()"},"vector<tuple<string,int,string>>":{"type_symbol":"vector<tuple<string,int,string>>","destructor":"vector<tuple<std::string,int,std::string>>"},"json":{"type_symbol":"json","destructor":"json"},"vector<int>":{"type_symbol":"vector<int>","destructor":"vector<int>"}},"events":[]},"top_level_astds":[{"name":"DetectionPattern","parameters":[{"name":"window_parameters","type":"json","domain":{"type":"UnboundedDomain"}},{"name":"kde_parameters","type":"double","domain":{"type":"UnboundedDomain"}},{"name":"kmeans_parameters","type":"double","domain":{"type":"UnboundedDomain"}},{"name":"lof_parameters","type":"int","domain":{"type":"UnboundedDomain"}}],"type":"QInterleave","typed_astd":{"attributes":[],"code":"","interruptCode":"","quantified_variable":{"name":"userId","type":"int","domain":{"type":"UnboundedDomain"}},"sub_astd":{"name":"","type":"Flow","typed_astd":{"attributes":[{"name":"data","type":"std::map<int,std::vector<int>>","initial_value":"{}"},{"name":"sliding_window","type":"window1*","initial_value":"new window1(window_parameters)"},{"name":"alerts","type":"vector<tuple<string,int,string>>","initial_value":"{}"}],"code":"","interruptCode":"","left_astd":{"name":"CombineModels","type":"Flow","invariant":"","typed_astd":{"attributes":[],"code":"","interruptCode":"","left_astd":{"name":"combination","type":"Flow","invariant":"","typed_astd":{"attributes":[{"name":"scores","type":"vector<int>","initial_value":"{}"}],"code":"","interruptCode":"","left_astd":{"name":"detectors","type":"QFlow","typed_astd":{"attributes":[{"name":"mapdetectors","type":"std::map<string,model*>","initial_value":"{Code::init_map(kde_parameters,kmeans_parameters,lof_parameters)}"}],"code":"","interruptCode":"","quantified_variable":{"name":"d","type":"string","domain":{"type":"EnumeratedDomain","value":["kmeans","kde","lof"]}},"sub_astd":{"name":"","type":"Flow","typed_astd":{"attributes":[],"code":"","interruptCode":"","left_astd":{"name":"training","type":"Automaton","typed_astd":{"attributes":[],"code":"","interruptCode":"","states":[{"name":"S0","astd":{"type":"Elem","typed_astd":{}},"entry_code":"","stay_code":"","exit_code":""}],"transitions":[{"arrow_type":"Local","arrow":{"from_state_name":"S0","to_state_name":"S0"},"event_template":{"label":"e","parameters":[{"parameter_kind":"Expression","parameter":"userId"},{"parameter_kind":"Capture","parameter":{"variable_name":"eventDate","type":"string"}},{"parameter_kind":"Capture","parameter":{"variable_name":"eventId","type":"string"}}],"when":[]},"guard":"","action":"{sliding_window->fit_partial(mapdetectors[d],data)}","step":false,"from_final_state_only":false}],"shallow_final_state_names":["S0"],"deep_final_state_names":[],"initial_state_name":"S0"}},"right_astd":{"name":"scoring","type":"Automaton","typed_astd":{"attributes":[],"code":"","interruptCode":"","states":[{"name":"S0","astd":{"type":"Elem","typed_astd":{}},"entry_code":"","stay_code":"","exit_code":""}],"transitions":[{"arrow_type":"Local","arrow":{"from_state_name":"S0","to_state_name":"S0"},"event_template":{"label":"e","parameters":[{"parameter_kind":"Expression","parameter":"userId"},{"parameter_kind":"Capture","parameter":{"variable_name":"eventDate","type":"string"}},{"parameter_kind":"Capture","parameter":{"variable_name":"eventId","type":"string"}}],"when":[]},"guard":"","action":"{mapdetectors[d]->score_partial(eventDate,eventId,scores)}","step":false,"from_final_state_only":false}],"shallow_final_state_names":["S0"],"deep_final_state_names":[],"initial_state_name":"S0"}}}}}},"right_astd":{"name":"majorityVote","type":"Automaton","invariant":"","typed_astd":{"attributes":[],"code":"","interruptCode":"","states":[{"name":"S0","astd":{"type":"Elem","typed_astd":{}},"entry_code":"","stay_code":"","exit_code":"","invariant":""}],"transitions":[{"arrow_type":"Local","arrow":{"from_state_name":"S0","to_state_name":"S0"},"event_template":{"label":"e","parameters":[{"parameter_kind":"Expression","parameter":"userId"},{"parameter_kind":"Capture","parameter":{"variable_name":"eventDate","type":"string"}},{"parameter_kind":"Capture","parameter":{"variable_name":"eventId","type":"string"}}],"when":[]},"guard":"","action":"{Code::majorityVote(scores,alerts,eventId,eventDate)}","step":false,"from_final_state_only":false}],"shallow_final_state_names":["S0"],"deep_final_state_names":[],"initial_state_name":"S0"}}}},"right_astd":{"name":"Data_Parser","type":"Automaton","typed_astd":{"attributes":[],"code":"","interruptCode":"","states":[{"name":"S0","astd":{"type":"Elem","typed_astd":{}},"entry_code":"","stay_code":"","exit_code":""}],"transitions":[{"arrow_type":"Local","arrow":{"from_state_name":"S0","to_state_name":"S0"},"event_template":{"label":"e","parameters":[{"parameter_kind":"Expression","parameter":"userId"},{"parameter_kind":"Capture","parameter":{"variable_name":"eventDate","type":"string"}},{"parameter_kind":"Capture","parameter":{"variable_name":"eventId","type":"string"}}],"when":[]},"guard":"","action":"{Code::formatting_data(data,sliding_window,eventDate)}","step":false,"from_final_state_only":false}],"shallow_final_state_names":["S0"],"deep_final_state_names":[],"initial_state_name":"S0"}}}},"right_astd":{"name":"TemporalInterval","type":"Kleene","invariant":"","typed_astd":{"attributes":[],"code":"","interruptCode":"","sub_astd":{"name":"","type":"TimedInterrupt","typed_astd":{"attributes":[{"name":"count","type":"int","initial_value":"0"}],"code":"","interruptCode":"{Code::alert(count)}","duration":"300","duration_unit":"Second","left_astd":{"name":"CountOccurrence","type":"Automaton","invariant":"","typed_astd":{"attributes":[],"code":"","interruptCode":"","states":[{"name":"S0","astd":{"type":"Elem","typed_astd":{}},"entry_code":"","stay_code":"","exit_code":"","invariant":""}],"transitions":[{"arrow_type":"Local","arrow":{"from_state_name":"S0","to_state_name":"S0"},"event_template":{"label":"e1","parameters":[{"parameter_kind":"Expression","parameter":"userId"},{"parameter_kind":"Capture","parameter":{"variable_name":"alertId","type":"string"}},{"parameter_kind":"Capture","parameter":{"variable_name":"alertSeverity","type":"string"}}],"when":[]},"guard":"alertSeverity == \"Medium\" || alertSeverity==\"High\"","action":"","step":false,"from_final_state_only":false}],"shallow_final_state_names":["S0"],"deep_final_state_names":[],"initial_state_name":"S0"}},"right_astd":{"name":"Alert","type":"Automaton","invariant":"","typed_astd":{"attributes":[],"code":"","interruptCode":"","states":[{"name":"S0","astd":{"type":"Elem","typed_astd":{}},"entry_code":"","stay_code":"","exit_code":"","invariant":""}],"transitions":[],"shallow_final_state_names":["S0"],"deep_final_state_names":[],"initial_state_name":"S0"}}}}}}}}}}],"conf":[]},"editor":{"id":274,"schemas":[],"native_types":[{"name":"window1*","type":"native","id":"id_42","symbol":"window1*","destructor":"~window()"},{"name":"std::map<int,std::vector<int>>","type":"native","id":"id_43","symbol":"map","destructor":"~map()"},{"name":"model*","type":"native","id":"id_44","symbol":"model.h","destructor":"~model()"},{"name":"double","type":"native","id":"id_68","symbol":"double","destructor":"delete"},{"name":"std::vector<std::string>","type":"native","id":"id_103","symbol":"vector","destructor":"~vector()"},{"name":"std::map<string,model*>","type":"native","id":"id_117","symbol":"map","destructor":"~map()"},{"name":"vector<tuple<string,int,string>>","type":"native","id":"id_132","symbol":"vector<tuple<string,int,string>>","destructor":"vector<tuple<std::string,int,std::string>>"},{"name":"json","type":"native","id":"id_133","symbol":"json","destructor":"json"},{"name":"vector<int>","type":"native","id":"id_134","symbol":"vector<int>","destructor":"vector<int>"}],"imports":[],"eventSignatures":[],"target":"C++","files":[{"astd":{"id":"id_1","position":{"x":10,"y":2},"width":1134,"height":827,"label":"DetectionPattern","initial":false,"entryCode":"","stayCode":"","exitCode":"","class":"astd","tabs":[{"id":"id_272","label":"","parent":"id_1","attributes":[],"code":"","interruptCode":"","test":false,"parameter_name":"","parameter_domain":"","variable":{"parent":"id_272","label":"userId","type":"int","domain":"","domainType":"UnboundedDomain"},"class":"||| x : T"},{"id":"id_273","label":"","parent":"id_1","attributes":[{"parent":"id_273","label":"data","type":"std::map<int,std::vector<int>>","value":"{}"},{"parent":"id_273","label":"sliding_window","type":"window1*","value":"new window1(window_parameters)"},{"parent":"id_273","label":"alerts","type":"vector<tuple<string,int,string>>","value":"{}"}],"code":"","interruptCode":"","test":false,"parameter_name":"","parameter_domain":"","class":"Ψ Flow"}],"state":"non-final","orderNumber":"","items":[{"id":"id_180","parent":"id_1","position":{"x":17,"y":44},"width":823,"height":365,"label":"CombineModels","initial":false,"entryCode":"","stayCode":"","exitCode":"","invariant":"","comment":"","class":"astd","tabs":[{"id":"id_267","label":"","parent":"id_180","attributes":[],"code":"","interruptCode":"","test":false,"parameter_name":"","parameter_domain":"","class":"Ψ Flow"}],"state":"non-final","orderNumber":"","items":[{"id":"id_126","parent":"id_180","position":{"x":203,"y":26},"width":604,"height":272,"label":"combination","initial":false,"entryCode":"","stayCode":"","exitCode":"","invariant":"","comment":"","class":"astd","tabs":[{"id":"id_265","label":"","parent":"id_126","attributes":[{"parent":"id_265","label":"scores","type":"vector<int>","value":"{}"}],"code":"","interruptCode":"","test":false,"parameter_name":"","parameter_domain":"","class":"Ψ Flow"}],"state":"non-final","orderNumber":"","items":[{"id":"id_61","parent":"id_126","position":{"x":19,"y":43},"width":378,"height":215,"label":"detectors","initial":false,"entryCode":"","stayCode":"","exitCode":"","class":"astd","tabs":[{"id":"id_262","label":"","parent":"id_61","attributes":[{"parent":"id_262","label":"mapdetectors","type":"std::map<string,model*>","value":"{Code::init_map(kde_parameters,kmeans_parameters,lof_parameters)}"}],"code":"","interruptCode":"","test":false,"parameter_name":"","parameter_domain":"","variable":{"parent":"id_262","label":"d","type":"string","domain":"\"kmeans\",\"kde\",\"lof\"","domainType":"EnumeratedDomain"},"class":"Ψ x : T"},{"id":"id_263","label":"","parent":"id_61","attributes":[],"code":"","interruptCode":"","test":false,"parameter_name":"","parameter_domain":"","class":"Ψ Flow"}],"state":"non-final","orderNumber":"","items":[{"id":"id_10","parent":"id_61","position":{"x":18,"y":46},"width":151,"height":139,"label":"training","initial":false,"entryCode":"","stayCode":"","exitCode":"","class":"astd","tabs":[{"id":"id_261","label":"","parent":"id_10","attributes":[],"code":"","interruptCode":"","test":false,"parameter_name":"","parameter_domain":"","class":"Automaton"}],"state":"non-final","orderNumber":"","items":[{"id":"id_14","parent":"id_10","position":{"x":64,"y":99},"width":30.72,"height":30,"label":"S0","initial":true,"entryCode":"","stayCode":"","exitCode":"","class":"state","final":true,"history":false,"deephistory":false}],"parameters":[],"test_parameters":[]},{"id":"id_11","parent":"id_61","position":{"x":195,"y":42},"width":158,"height":149,"label":"scoring","initial":false,"entryCode":"","stayCode":"","exitCode":"","class":"astd","tabs":[{"id":"id_260","label":"","parent":"id_11","attributes":[],"code":"","interruptCode":"","test":false,"parameter_name":"","parameter_domain":"","class":"Automaton"}],"state":"non-final","orderNumber":"","items":[{"id":"id_18","parent":"id_11","position":{"x":63,"y":101},"width":30.72,"height":30,"label":"S0","initial":true,"entryCode":"","stayCode":"","exitCode":"","class":"state","final":true,"history":false,"deephistory":false}],"parameters":[],"test_parameters":[]}],"parameters":[],"test_parameters":[]},{"id":"id_128","parent":"id_126","position":{"x":424,"y":74},"width":166,"height":166,"label":"majorityVote","initial":false,"entryCode":"","stayCode":"","exitCode":"","invariant":"","comment":"","class":"astd","tabs":[{"id":"id_264","label":"","parent":"id_128","attributes":[],"code":"","interruptCode":"","test":false,"parameter_name":"","parameter_domain":"","class":"Automaton"}],"state":"non-final","orderNumber":"","items":[{"id":"id_130","parent":"id_128","position":{"x":61,"y":120},"width":30.72,"height":30,"label":"S0","initial":true,"entryCode":"","stayCode":"","exitCode":"","invariant":"","comment":"","class":"state","final":true,"history":false,"deephistory":false}],"parameters":[],"test_parameters":[]}],"parameters":[],"test_parameters":[]},{"id":"id_4","parent":"id_180","position":{"x":21,"y":74},"width":175,"height":160,"label":"Data_Parser","initial":false,"entryCode":"","stayCode":"","exitCode":"","class":"astd","tabs":[{"id":"id_266","label":"","parent":"id_4","attributes":[],"code":"","interruptCode":"","test":false,"parameter_name":"","parameter_domain":"","class":"Automaton"}],"state":"non-final","orderNumber":"","items":[{"id":"id_6","parent":"id_4","position":{"x":63,"y":118},"width":30,"height":32,"label":"S0","initial":true,"entryCode":"","stayCode":"","exitCode":"","class":"state","final":true,"history":false,"deephistory":false}],"parameters":[],"test_parameters":[]}],"parameters":[],"test_parameters":[]},{"id":"id_182","parent":"id_1","position":{"x":20,"y":439},"width":784,"height":311,"label":"TemporalInterval","initial":false,"entryCode":"","stayCode":"","exitCode":"","invariant":"","comment":"","class":"astd","tabs":[{"id":"id_270","label":"","parent":"id_182","attributes":[],"code":"","interruptCode":"","test":false,"parameter_name":"","parameter_domain":"","class":"★ Closure"},{"id":"id_271","label":"","parent":"id_182","attributes":[{"parent":"id_271","label":"count","type":"int","value":"0"}],"code":"","interruptCode":"{Code::alert(count)}","test":false,"parameter_name":"","parameter_domain":"","class":"Timed interrupt","timer":"300","timeUnit":"Second"}],"state":"non-final","orderNumber":"","items":[{"id":"id_255","parent":"id_182","position":{"x":456,"y":42},"width":244,"height":229,"label":"Alert","initial":false,"entryCode":"","stayCode":"","exitCode":"","invariant":"","comment":"","class":"astd","tabs":[{"id":"id_269","label":"","parent":"id_255","attributes":[],"code":"","interruptCode":"","test":false,"parameter_name":"","parameter_domain":"","class":"Automaton"}],"state":"non-final","orderNumber":"","items":[{"id":"id_257","parent":"id_255","position":{"x":75,"y":83},"width":30.72,"height":30,"label":"S0","initial":true,"entryCode":"","stayCode":"","exitCode":"","invariant":"","comment":"","class":"state","final":true,"history":false,"deephistory":false}],"parameters":[],"test_parameters":[]},{"id":"id_251","parent":"id_182","position":{"x":45,"y":52},"width":260,"height":218,"label":"CountOccurrence","initial":false,"entryCode":"","stayCode":"","exitCode":"","invariant":"","comment":"","class":"astd","tabs":[{"id":"id_268","label":"","parent":"id_251","attributes":[],"code":"","interruptCode":"","test":false,"parameter_name":"","parameter_domain":"","class":"Automaton"}],"state":"non-final","orderNumber":"","items":[{"id":"id_253","parent":"id_251","position":{"x":87,"y":104},"width":30.72,"height":30,"label":"S0","initial":true,"entryCode":"","stayCode":"","exitCode":"","invariant":"","comment":"","class":"state","final":true,"history":false,"deephistory":false}],"parameters":[],"test_parameters":[]}],"parameters":[],"test_parameters":[]}],"parameters":[{"parent":"id_1","label":"window_parameters","type":"json","domain":"","domainType":"UnboundedDomain"},{"parent":"id_1","label":"kde_parameters","type":"double","domain":"","domainType":"UnboundedDomain"},{"parent":"id_1","label":"kmeans_parameters","type":"double","domain":"","domainType":"UnboundedDomain"},{"parent":"id_1","label":"lof_parameters","type":"int","domain":"","domainType":"UnboundedDomain"}],"test_parameters":[]},"links":[{"id":"id_7","source":"id_6","destination":"id_6","details":true,"parameters":"userId,?eventDate:string,?eventId:string","guard":"","when":"","displayNumber":"3","code":"{Code::formatting_data(data,sliding_window,eventDate)}","label":"e","type":"default","final":false,"inflexion":[],"test_parameters":[],"commentLabel":"","parameterize":"[]"},{"id":"id_15","source":"id_14","destination":"id_14","details":true,"parameters":"userId,?eventDate:string,?eventId:string","guard":"","when":"","displayNumber":"3","code":"{sliding_window->fit_partial(mapdetectors[d],data)}","label":"e","type":"default","final":false,"inflexion":[],"test_parameters":[],"commentLabel":"","parameterize":"[]"},{"id":"id_19","source":"id_18","destination":"id_18","details":true,"parameters":"userId,?eventDate:string,?eventId:string","guard":"","when":"","displayNumber":"3","code":"{mapdetectors[d]->score_partial(eventDate,eventId,scores)}","label":"e","type":"default","final":false,"inflexion":[],"test_parameters":[],"commentLabel":"","parameterize":"[]"},{"id":"id_131","source":"id_130","destination":"id_130","details":true,"comment":"","parameters":"userId,?eventDate:string,?eventId:string","guard":"","when":"","displayNumber":"100","code":"{Code::majorityVote(scores,alerts,eventId,eventDate)}","label":"e","type":"default","final":false,"inflexion":[],"test_parameters":[],"commentLabel":"","parameterize":"[]"},{"id":"id_254","source":"id_253","destination":"id_253","details":true,"comment":"","parameters":"userId,?alertId:string,?alertSeverity:string","guard":"alertSeverity == \"Medium\" || alertSeverity==\"High\"","when":"","displayNumber":3,"code":"","label":"e1","type":"default","final":false,"inflexion":[],"test_parameters":[],"commentLabel":"","parameterize":"[]"},{"id":"id_258","source":"id_251","destination":"id_255","details":true,"comment":"","parameters":"","guard":"","when":"","displayNumber":3,"code":"","label":"?","type":"Timeout","final":false,"inflexion":[],"test_parameters":[],"commentLabel":"","parameterize":"[]"}]}],"traces":[],"config":[]}}