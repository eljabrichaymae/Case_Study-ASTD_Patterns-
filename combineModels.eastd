{"iastd":{"target":"c++","imports":[],"type_definitions":{"schemas":[],"native_types":{"window*":{"type_symbol":"window/window.h","destructor":"~window()"},"std::map<int,std::vector<int>>":{"type_symbol":"map","destructor":"~map()"},"model*":{"type_symbol":"model.h","destructor":"~model()"},"double":{"type_symbol":"double","destructor":"delete"},"std::vector<std::string>":{"type_symbol":"vector","destructor":"~vector()"},"std::map<string,model*>":{"type_symbol":"map","destructor":"~map()"},"vector<tuple<std::string,int,std::string>>":{"type_symbol":"vector<tuple<std::string,int,std::string>>","destructor":"vector<tuple<std::string,int,std::string>>"},"json":{"type_symbol":"json","destructor":"json"},"vector<int>":{"type_symbol":"vector<int>","destructor":"vector<int>"}},"events":[]},"top_level_astds":[{"name":"CombineModels","parameters":[{"name":"window_parameters","type":"json","domain":{"type":"UnboundedDomain"}},{"name":"kde_parameters","type":"double","domain":{"type":"UnboundedDomain"}},{"name":"kmeans_parameters","type":"double","domain":{"type":"UnboundedDomain"}},{"name":"lof_parameters","type":"int","domain":{"type":"UnboundedDomain"}}],"type":"QInterleave","typed_astd":{"attributes":[{"name":"alerts","type":"vector<tuple<std::string,int,std::string>>","initial_value":"{}"}],"code":"","interruptCode":"","quantified_variable":{"name":"userId","type":"int","domain":{"type":"UnboundedDomain"}},"sub_astd":{"name":"Detection_Per_User","type":"Flow","typed_astd":{"attributes":[{"name":"window","type":"window*","initial_value":"new window()"},{"name":"data","type":"std::map<int,std::vector<int>>","initial_value":"{}"}],"code":"","interruptCode":"","left_astd":{"name":"combination","type":"Flow","invariant":"","typed_astd":{"attributes":[{"name":"scores","type":"vector<int>","initial_value":"{}"}],"code":"","interruptCode":"","left_astd":{"name":"detectors","type":"QFlow","typed_astd":{"attributes":[{"name":"detectors","type":"std::map<string,model*>","initial_value":"{Code::init_map()}"}],"code":"","interruptCode":"","quantified_variable":{"name":"d","type":"string","domain":{"type":"EnumeratedDomain","value":["kde","kmeans","knn","lof"]}},"sub_astd":{"name":"","type":"Flow","typed_astd":{"attributes":[],"code":"","interruptCode":"","left_astd":{"name":"training","type":"Automaton","typed_astd":{"attributes":[],"code":"","interruptCode":"","states":[{"name":"S0","astd":{"type":"Elem","typed_astd":{}},"entry_code":"","stay_code":"","exit_code":""}],"transitions":[{"arrow_type":"Local","arrow":{"from_state_name":"S0","to_state_name":"S0"},"event_template":{"label":"e","parameters":[{"parameter_kind":"Expression","parameter":"userId"},{"parameter_kind":"Capture","parameter":{"variable_name":"eventDate","type":"string"}},{"parameter_kind":"Capture","parameter":{"variable_name":"eventId","type":"string"}}],"when":[]},"guard":"","action":"{window->fit_partial(detectors[d],data)}","step":false,"from_final_state_only":false}],"shallow_final_state_names":["S0"],"deep_final_state_names":[],"initial_state_name":"S0"}},"right_astd":{"name":"scoring","type":"Automaton","typed_astd":{"attributes":[],"code":"","interruptCode":"","states":[{"name":"S0","astd":{"type":"Elem","typed_astd":{}},"entry_code":"","stay_code":"","exit_code":""}],"transitions":[{"arrow_type":"Local","arrow":{"from_state_name":"S0","to_state_name":"S0"},"event_template":{"label":"e","parameters":[{"parameter_kind":"Expression","parameter":"userId"},{"parameter_kind":"Capture","parameter":{"variable_name":"eventDate","type":"string"}},{"parameter_kind":"Capture","parameter":{"variable_name":"eventId","type":"string"}}],"when":[]},"guard":"","action":"{detectors[d]->score_partial(eventDate,eventId,score)}","step":false,"from_final_state_only":false}],"shallow_final_state_names":["S0"],"deep_final_state_names":[],"initial_state_name":"S0"}}}}}},"right_astd":{"name":"majorityVote","type":"Automaton","invariant":"","typed_astd":{"attributes":[],"code":"","interruptCode":"","states":[{"name":"S0","astd":{"type":"Elem","typed_astd":{}},"entry_code":"","stay_code":"","exit_code":"","invariant":""}],"transitions":[{"arrow_type":"Local","arrow":{"from_state_name":"S0","to_state_name":"S0"},"event_template":{"label":"e","parameters":[{"parameter_kind":"Expression","parameter":"userId"},{"parameter_kind":"Capture","parameter":{"variable_name":"eventDate","type":"string"}},{"parameter_kind":"Capture","parameter":{"variable_name":"eventId","type":"string"}}],"when":[]},"guard":"","action":"{Code::majorityVote(scores,alerts,eventId,eventDate)}","step":false,"from_final_state_only":false}],"shallow_final_state_names":["S0"],"deep_final_state_names":[],"initial_state_name":"S0"}}}},"right_astd":{"name":"Data_Parser","type":"Automaton","typed_astd":{"attributes":[],"code":"","interruptCode":"","states":[{"name":"S0","astd":{"type":"Elem","typed_astd":{}},"entry_code":"","stay_code":"","exit_code":""}],"transitions":[{"arrow_type":"Local","arrow":{"from_state_name":"S0","to_state_name":"S0"},"event_template":{"label":"e","parameters":[{"parameter_kind":"Expression","parameter":"userId"},{"parameter_kind":"Capture","parameter":{"variable_name":"eventDate","type":"string"}},{"parameter_kind":"Capture","parameter":{"variable_name":"eventId","type":"string"}}],"when":[]},"guard":"","action":"{Code::formatting_data(data,window,eventDate)}","step":false,"from_final_state_only":false}],"shallow_final_state_names":["S0"],"deep_final_state_names":[],"initial_state_name":"S0"}}}}}}],"conf":[]},"editor":{"id":135,"schemas":[],"native_types":[{"name":"window*","type":"native","id":"id_42","symbol":"window/window.h","destructor":"~window()"},{"name":"std::map<int,std::vector<int>>","type":"native","id":"id_43","symbol":"map","destructor":"~map()"},{"name":"model*","type":"native","id":"id_44","symbol":"model.h","destructor":"~model()"},{"name":"double","type":"native","id":"id_68","symbol":"double","destructor":"delete"},{"name":"std::vector<std::string>","type":"native","id":"id_103","symbol":"vector","destructor":"~vector()"},{"name":"std::map<string,model*>","type":"native","id":"id_117","symbol":"map","destructor":"~map()"},{"name":"vector<tuple<std::string,int,std::string>>","type":"native","id":"id_132","symbol":"vector<tuple<std::string,int,std::string>>","destructor":"vector<tuple<std::string,int,std::string>>"},{"name":"json","type":"native","id":"id_133","symbol":"json","destructor":"json"},{"name":"vector<int>","type":"native","id":"id_134","symbol":"vector<int>","destructor":"vector<int>"}],"imports":[],"eventSignatures":[],"target":"C++","files":[{"astd":{"id":"id_1","position":{"x":10,"y":2},"width":1122,"height":435,"label":"CombineModels","initial":false,"entryCode":"","stayCode":"","exitCode":"","class":"astd","tabs":[{"id":"id_124","label":"","parent":"id_1","attributes":[{"parent":"id_124","label":"alerts","type":"vector<tuple<std::string,int,std::string>>","value":"{}"}],"code":"","interruptCode":"","test":false,"parameter_name":"","parameter_domain":"","variable":{"parent":"id_124","label":"userId","type":"int","domain":"","domainType":"UnboundedDomain"},"class":"||| x : T"},{"id":"id_125","label":"Detection_Per_User","parent":"id_1","attributes":[{"parent":"id_125","label":"window","type":"window*","value":"new window()"},{"parent":"id_125","label":"data","type":"std::map<int,std::vector<int>>","value":"{}"}],"code":"","interruptCode":"","test":false,"parameter_name":"","parameter_domain":"","class":"Ψ Flow"}],"state":"non-final","items":[{"id":"id_126","parent":"id_1","position":{"x":208,"y":51},"width":901,"height":351,"label":"combination","initial":false,"entryCode":"","stayCode":"","exitCode":"","invariant":"","comment":"","class":"astd","tabs":[{"id":"id_127","label":"","parent":"id_126","attributes":[{"parent":"id_127","label":"scores","type":"vector<int>","value":"{}"}],"code":"","interruptCode":"","test":false,"parameter_name":"","parameter_domain":"","class":"Ψ Flow"}],"state":"non-final","items":[{"id":"id_61","parent":"id_126","position":{"x":19,"y":43},"width":486,"height":265,"label":"detectors","initial":false,"entryCode":"","stayCode":"","exitCode":"","class":"astd","tabs":[{"id":"id_121","label":"","parent":"id_61","attributes":[{"parent":"id_121","label":"detectors","type":"std::map<string,model*>","value":"{Code::init_map()}"}],"code":"","interruptCode":"","test":false,"parameter_name":"","parameter_domain":"","variable":{"parent":"id_121","label":"d","type":"string","domain":"\"kde\",\"kmeans\",\"knn\",\"lof\"","domainType":"EnumeratedDomain"},"class":"Ψ x : T"},{"id":"id_122","label":"","parent":"id_61","attributes":[],"code":"","interruptCode":"","test":false,"parameter_name":"","parameter_domain":"","class":"Ψ Flow"}],"state":"non-final","items":[{"id":"id_10","parent":"id_61","position":{"x":27,"y":54},"width":152,"height":174,"label":"training","initial":false,"entryCode":"","stayCode":"","exitCode":"","class":"astd","tabs":[{"id":"id_119","label":"","parent":"id_10","attributes":[],"code":"","interruptCode":"","test":false,"parameter_name":"","parameter_domain":"","class":"Automaton"}],"state":"non-final","items":[{"id":"id_14","parent":"id_10","position":{"x":69,"y":121},"width":30.72,"height":30,"label":"S0","initial":true,"entryCode":"","stayCode":"","exitCode":"","class":"state","final":true,"history":false,"deephistory":false}],"parameters":[],"test_parameters":[]},{"id":"id_11","parent":"id_61","position":{"x":237,"y":51},"width":160,"height":177,"label":"scoring","initial":false,"entryCode":"","stayCode":"","exitCode":"","class":"astd","tabs":[{"id":"id_120","label":"","parent":"id_11","attributes":[],"code":"","interruptCode":"","test":false,"parameter_name":"","parameter_domain":"","class":"Automaton"}],"state":"non-final","items":[{"id":"id_18","parent":"id_11","position":{"x":59,"y":124},"width":30.72,"height":30,"label":"S0","initial":true,"entryCode":"","stayCode":"","exitCode":"","class":"state","final":true,"history":false,"deephistory":false}],"parameters":[],"test_parameters":[]}],"parameters":[],"test_parameters":[]},{"id":"id_128","parent":"id_126","position":{"x":573,"y":62},"width":213,"height":217,"label":"majorityVote","initial":false,"entryCode":"","stayCode":"","exitCode":"","invariant":"","comment":"","class":"astd","tabs":[{"id":"id_129","label":"","parent":"id_128","attributes":[],"code":"","interruptCode":"","test":false,"parameter_name":"","parameter_domain":"","class":"Automaton"}],"state":"non-final","items":[{"id":"id_130","parent":"id_128","position":{"x":110,"y":150},"width":30.72,"height":30,"label":"S0","initial":true,"entryCode":"","stayCode":"","exitCode":"","invariant":"","comment":"","class":"state","final":true,"history":false,"deephistory":false}],"parameters":[],"test_parameters":[]}],"parameters":[],"test_parameters":[]},{"id":"id_4","parent":"id_1","position":{"x":31,"y":149},"width":157,"height":179,"label":"Data_Parser","initial":false,"entryCode":"","stayCode":"","exitCode":"","class":"astd","tabs":[{"id":"id_123","label":"","parent":"id_4","attributes":[],"code":"","interruptCode":"","test":false,"parameter_name":"","parameter_domain":"","class":"Automaton"}],"state":"non-final","items":[{"id":"id_6","parent":"id_4","position":{"x":63,"y":118},"width":30,"height":32,"label":"S0","initial":true,"entryCode":"","stayCode":"","exitCode":"","class":"state","final":true,"history":false,"deephistory":false}],"parameters":[],"test_parameters":[]}],"parameters":[{"parent":"id_1","label":"window_parameters","type":"json","domain":"","domainType":"UnboundedDomain"},{"parent":"id_1","label":"kde_parameters","type":"double","domain":"","domainType":"UnboundedDomain"},{"parent":"id_1","label":"kmeans_parameters","type":"double","domain":"","domainType":"UnboundedDomain"},{"parent":"id_1","label":"lof_parameters","type":"int","domain":"","domainType":"UnboundedDomain"}],"test_parameters":[]},"links":[{"id":"id_7","source":"id_6","destination":"id_6","details":true,"parameters":"userId,?eventDate:string,?eventId:string","guard":"","when":"","displayNumber":"3","code":"{Code::formatting_data(data,window,eventDate)}","label":"e","type":"default","final":false,"inflexion":[],"test_parameters":[],"parameterize":"[]"},{"id":"id_15","source":"id_14","destination":"id_14","details":true,"parameters":"userId,?eventDate:string,?eventId:string","guard":"","when":"","displayNumber":"3","code":"{window->fit_partial(detectors[d],data)}","label":"e","type":"default","final":false,"inflexion":[],"test_parameters":[],"parameterize":"[]"},{"id":"id_19","source":"id_18","destination":"id_18","details":true,"parameters":"userId,?eventDate:string,?eventId:string","guard":"","when":"","displayNumber":"3","code":"{detectors[d]->score_partial(eventDate,eventId,score)}","label":"e","type":"default","final":false,"inflexion":[],"test_parameters":[],"parameterize":"[]"},{"id":"id_131","source":"id_130","destination":"id_130","details":true,"comment":"","parameters":"userId,?eventDate:string,?eventId:string","guard":"","when":"","displayNumber":"100","code":"{Code::majorityVote(scores,alerts,eventId,eventDate)}","label":"e","type":"default","final":false,"inflexion":[],"test_parameters":[],"parameterize":"[]"}]}],"traces":[],"config":[]}}